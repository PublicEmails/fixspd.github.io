
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>FixSPD</title>
  <script>
  if (typeof console == "undefined") {
    this.console = {log: function() {}};
}
if (!String.prototype.endsWith) {
  String.prototype.endsWith = function(searchString, position) {
      var subjectString = this.toString();
      if (typeof position !== 'number' || !isFinite(position) || Math.floor(position) !== position || position > subjectString.length) {
        position = subjectString.length;
      }
      position -= searchString.length;
      var lastIndex = subjectString.indexOf(searchString, position);
      return lastIndex !== -1 && lastIndex === position;
  };
}
  </script>
  <base target="_self">
  <meta name="description" content="A admin dashboard theme that will get you started with Bootstrap 4." />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="google" value="notranslate">
  <link rel="shortcut icon" href="/img/codeply_ico.jpg">
  

  
  <!--stylesheets / link tags loaded here-->


<script src="https://www.atlasestateagents.co.uk/javascript/tether.min.js"></script><!-- Tether for Bootstrap --> 

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.2/css/bootstrap.min.css" />
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" />
  

  

  <style type="text/css">body {
  padding-top:62px;
}

body, html {
  height:100%;
}

/* workaround modal-open padding issue */
body.modal-open {
    padding-right:0 !important;
}

/* workaround bs 4 horizontal scrollbar */
.container-fluid >.row {
    margin-left: -15px;
    margin-right: -10px;
}

#sidebar {
   padding-left:0;
}

/*
 * Off Canvas at medium breakpoint
 * --------------------------------------------------
 */
@media screen and (max-width: 48em) {

  .row-offcanvas {
    position: relative;
    -webkit-transition: all 0.25s ease-out;
    -moz-transition: all 0.25s ease-out;
    transition: all 0.25s ease-out;
  }

  .row-offcanvas-left
  .sidebar-offcanvas {
    left: -33%;
  }

  .row-offcanvas-left.active {
    left: 33%;
  }

  .sidebar-offcanvas {
    background-color:#f6f6f6;
    position: absolute;
    top: 0;
    width: 33%;
    height: 100%;
  }
}

/*
 * Off Canvas wider at sm breakpoint
 * --------------------------------------------------
 */
@media screen and (max-width: 34em) {
  .row-offcanvas-left
  .sidebar-offcanvas {
    left: -45%;
  }

  .row-offcanvas-left.active {
    left: 45%;
  }
  
  .sidebar-offcanvas {
    width: 45%;
  }
}


/* responsive nav stacked liked 3.x */
@media(max-width:34em) {
    .navbar .navbar-brand {
        float:none;
        display: block;
    }
    .navbar .navbar-nav>.nav-item {
        float: none;
        margin-left: .1rem;
    }
    .navbar .navbar-nav {
        float:none !important;
    }
}

.card {
    overflow:hidden;
}

.card-block .rotate {
    z-index: 8;
    float: right;
    height: 100%;
}

.card-block .rotate i {
    color: rgba(20, 20, 20, 0.15);
    position: absolute;
    left: 0;
    left: auto;
    right: -10px;
    bottom: 0;
    display: block;
    -webkit-transform: rotate(-44deg);
    -moz-transform: rotate(-44deg);
    -o-transform: rotate(-44deg);
    -ms-transform: rotate(-44deg);
    transform: rotate(-44deg);
}
.navbar-brand {
padding-left:48px;
background:url('logo.png') 0 7px no-repeat;
}
html, body {height: 100%}

.sidebar{
    background-color:#eee;
    position: absolute;
    top: 0;
    bottom: 0;
    right: 0;
}

.small-box {
  padding-left:10px;
  width:200px;
}
.small-box h3 {
  font-size:14px;
  font-weight:bold;
}
.pie_chart {
	width:300px;
	height:300px;
	overflow:auto;
	margin:0 10px 10px 0;
	float:left;
}
.chart-legend li {
	list-style:none;
	margin:0;padding:0;
}
.chart-legend li span{
    display: inline-block;
    width: 12px;
    height: 12px;
    margin-right: 5px;
}
.navbar-dark .navbar-nav .nav-link {
	color:#FFF !important;
}
</style>

</head>
<body >
  <nav class="navbar navbar-fixed-top navbar-dark bg-primary">
    <button class="navbar-toggler hidden-sm-up pull-right" type="button" data-toggle="collapse" data-target="#collapsingNavbar">
        ☰
    </button>
    <a class="navbar-brand" href="#">FixSPD</a>
    <div class="collapse navbar-toggleable-xs" id="collapsingNavbar">
        <ul class="nav navbar-nav">
            <li class="nav-item">
                <a class="nav-link" href="#">About FixSPD</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">InsideSPD</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#features">Problem focuses</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#myAlert">Get involved</a>
            </li>
        </ul>
    </div>
</nav>
<div class="container-fluid" id="main">
    <div class="row row-offcanvas row-offcanvas-left">
        
        <!--/col-->

        <div class="col-md-9 col-lg-10 main">
          <h2>Public Disclosure Unit</h2>
          <script src="https://fixspd.org/js/webmaster_toolkit_for_socrata.js"></script> 
<p>There are <span class="socrata_sum_of_counts" 
data-urls="https://data.seattle.gov/resource/a4j2-uu8v.json?$select=count(*)&$where=completed_date%20IS%20NULL;https://data.seattle.gov/resource/ppwx-mtmh.json?$select=count(*)&$where=close_date%20IS%20NULL"></span> total open requests: <span class="socrata_count" 
data-url="https://data.seattle.gov/resource/a4j2-uu8v.json?$select=count(*)&$where=completed_date%20IS%20NULL"></span>
in the old system and <span class="socrata_count" 
data-url="https://data.seattle.gov/resource/ppwx-mtmh.json?$select=count(*)&$where=close_date%20IS%20NULL"></span> in the new system. Some records requests are on <a href="https://www.muckrock.com/foi/list/?agency=227&sort=date_submitted&order=desc">MuckRock</a>.</a></p>
          <p>In the new system there have been <span class="socrata_count" 
data-url="https://data.seattle.gov/resource/ppwx-mtmh.json?$select=count(*)"></span> total requests.</p>
          <style>
          #backlog_table tr {
            background:rgba(0,0,0,0.6);  
          }
          table { 
    border-spacing:0;
    border-collapse:collapse;
}
.table th, .table td {
  padding:3px;
}
.line_chart {
	width:100%;
	height:400px;
}
          </style>
          <div id="backlog_table" class="sodaplayground pie_chart" style="background:#000 url('/images/PDU_discs.jpg') no-repeat;color:#FFF;background-size:contain;" data-show-row-num="true" data-heading="Backlog in old system" data-type="table" data-url="https://data.seattle.gov/resource/a4j2-uu8v.json?$select=item_requested,%20received_date&$order=received_date&$where=completed_date%20IS%20NULL&$limit=20000" data-cols="received_date,item_requested" data-labels="Received date,Short description"></div>
          <div class="sodaplayground pie_chart" data-heading="Requester type in new system" data-type="pie_chart" data-domain="data.seattle.gov" data-datasetid="ppwx-mtmh" data-column="city_requestertype_internal"></div>

          <div class="sodaplayground pie_chart" data-heading="Status of requests in new system" data-type="pie_chart" data-domain="data.seattle.gov" data-datasetid="ppwx-mtmh" data-column="request_status"></div>
          <div class="sodaplayground pie_chart" data-heading="How requests were sent in new system" data-type="pie_chart" data-domain="data.seattle.gov" data-datasetid="ppwx-mtmh" data-column="source"></div>
          <div class="sodaplayground pie_chart" data-heading="Deliverly preference in new system" data-type="pie_chart" data-domain="data.seattle.gov" data-datasetid="ppwx-mtmh" data-column="spd_receiptofrecordspreference"></div>
          
          <div class="sodaplayground pie_chart" data-heading="What types of records were requested in new system" data-type="table_of_boolean_percentages" data-domain="data.seattle.gov" data-datasetid="ppwx-mtmh" data-columns="spd_recreqincidentreportyesno,spd_recreqfollowupinvestigationyesno,spd_recreqphotoyesno,spd_recreqspd911yesno,spd_recreqvideoyesno,spd_recreqotheryesno" data-labels="Requested incident report,Requested follow up investigation report,Requested photos,Requested 911,Requested videos,Requested other" data-trueis="Yes"></div>
          <div class="sodaplayground pie_chart" data-heading="The {{ count }} employees assigned to the Public Disclosure Unit as of {{ asof }}" data-type="table" data-labels="Name,Title" data-cols="name,rank_title_description" data-domain="opendata.socrata.com" data-datasetid="aspn-jfpg" data-q="disclosure" data-variable-count="count(*)"></div>
          <div class="sodaplayground pie_chart" data-heading="Top requester accounts in new system" data-type="horizontal_bar_chart" data-domain="communities.socrata.com" data-datasetid="ip9b-6red" data-query="SELECT%20customer_name,number_of_requests%20LIMIT%2010"></div>
<div class="clear"></div>
          <div class="sodaplayground line_chart" data-type="line_chart" data-heading="Number of opened records requests per day" data-url="https://data.seattle.gov/resource/ppwx-mtmh.json?$select=date_trunc_ymd(create_date)%20as%20date,count(*)%20as%20count&$group=date_trunc_ymd(create_date)&$order=date_trunc_ymd(create_date)" data-y="count" data-x="date"></div>
          <div class="sodaplayground line_chart" data-type="line_chart" data-heading="Number of closed records requests per day" data-url="https://data.seattle.gov/resource/ppwx-mtmh.json?$select=date_trunc_ymd(close_date)%20as%20date,count(*)%20as%20count&$group=date_trunc_ymd(close_date)&$order=date_trunc_ymd(close_date)" data-y="count" data-x="date"></div>
          
          
          <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/1.0.2/Chart.min.js"></script>
<script   src="https://code.jquery.com/jquery-2.2.2.min.js"   integrity="sha256-36cp2Co+/62rEAAYHLmRCPIych47CvdM+uTBJwSzWjI="   crossorigin="anonymous"></script>
<style>
#chartjs-tooltip {
     opacity: 0;
     position: absolute;
     background: rgba(0, 0, 0, .7);
     color: white;
     padding: 3px;
     border-radius: 3px;
     -webkit-transition: all .1s ease;
     transition: all .1s ease;
     pointer-events: none;
     -webkit-transform: translate(-50%, 0);
     transform: translate(-50%, 0);
 }
 .breakdown {
 color:#FFF;
 font-size:12px;
 
 }
 .breakdown td, .breakdown th {
 	vertical-align:top;
 	padding:3px;
 	border:1px solid #FFF;
 }
 .clear {
 	clear:left;
 }
</style>
<div class="clear"></div>
<!-- line chart canvas element --><h3>Number of new records requests per day in new system</h3>
<canvas id="opened_requests_per_day" style="width:100%;height:400px;"></canvas>
<h3>Number of closed records requests per day in new system</h3>
<canvas id="closed_requests_per_day" style="width:100%;height:400px;"></canvas>
<div id="chartjs-tooltip"></div>
<script>
  var url = 'https://data.seattle.gov/resource/ppwx-mtmh.json?$select=date_trunc_ymd(create_date)%20as%20date,count(*)%20as%20count&$group=date_trunc_ymd(create_date)&$order=date_trunc_ymd(create_date)';
  var data = JSON.parse($.ajax({
            type: "GET",
            url: url,
            async: false
        }).responseText);
  var labels = [];
  var counts = [];
  $.each(data, function(i, v) {
    labels.push(v['date']);
    counts.push(parseInt(v['count']));
  });
	// line chart data
	var buyerData = {
		labels : labels,
		datasets : [
		{
				fillColor : "rgba(172,194,132,0.4)",
				strokeColor : "#ACC26D",
				pointColor : "#fff",
				pointStrokeColor : "#9DB86D",
				data : counts,
        pointHighlightFill: "blue",
        pointHighlightStroke: "rgba(220,220,220,1)"
        
			}
		]
    
	}
	
	// get line chart canvas
	var opened_requests_per_day = document.getElementById('opened_requests_per_day').getContext('2d');

	// draw line chart
	new Chart(opened_requests_per_day).Line(buyerData,{pointHitDetectionRadius:5,customTooltips: function (tooltip) {
        var tooltipEl = $('#chartjs-tooltip');

        if (!tooltip) {
            tooltipEl.css({
                opacity: 0
            });
            return;
        }
       
        tooltipEl.removeClass('above below');
        tooltipEl.addClass(tooltip.yAlign);
        console.log('hi');
        // split out the label and value and make your own tooltip here
        var parts = tooltip.text.split(":");
        console.log(parts);
        var url = 'https://data.seattle.gov/resource/ppwx-mtmh.json?$select=city_requestertype_internal as req,count(*) as count&$group=city_requestertype_internal&$where=date_trunc_ymd(create_date) = "'+parts[0]+':00:00"';
        var data = JSON.parse($.ajax({
            type: "GET",
            url: url,
            async: false
        }).responseText);
        dataBreakdowns = {}
        $.each(data, function(i, v) {
          dataBreakdowns[v['req']] = v['count'];
        });
        var innerHtml = '<span>'+parts[3]+' requests</span><br/>Requester types<br/><table class="breakdown"><tr>';
        breakdown_headers = ['Media', 'Attorney', 'Individual', 'Insurance', 'Public Agency', 'Other', 'Inmate', 'Unknown'];
        breakdown_headers_html = '';
        breakdown_counts_html = '';
        $.each(breakdown_headers, function(i, v) {
          breakdown_headers_html += '<th>'+v+'</th>';
          if (v=='Unknown') {
            var url = 'https://data.seattle.gov/resource/ppwx-mtmh.json?$select=count(*) as count&$where=city_requestertype_internal IS NULL AND date_trunc_ymd(create_date) = "'+parts[0]+':00:00"';
            var data = JSON.parse($.ajax({
                type: "GET",
                url: url,
                async: false
            }).responseText);
            try {
              breakdown_counts_html += '<td>('+data[0]['count']+')</td>';
            } catch (e) {
              breakdown_counts_html += '<td>0% (0)</td>';
            }
          } else {
            if (v in dataBreakdowns) {
              breakdown_counts_html += '<td>('+dataBreakdowns[v]+')</td>';
            } else {
              breakdown_counts_html += '<td>0% (0)</td>';
            }
          }
        });
        innerHtml += breakdown_headers_html +'</tr><tr>'+breakdown_counts_html+'</tr></table>';
        innerHtml += 'Request statuses<br/>';
        innerHtml += 'Request sources<br/>';
        innerHtml += 'Receipt preferences<br/>';
        tooltipEl.html(innerHtml);

        tooltipEl.css({
            opacity: 1,
            left: tooltip.chart.canvas.offsetLeft + tooltip.x + 'px',
            top: tooltip.chart.canvas.offsetTop + tooltip.y + 'px',
            fontFamily: tooltip.fontFamily,
            fontSize: tooltip.fontSize,
            fontStyle: tooltip.fontStyle,
        });
    }});
    var url = 'https://data.seattle.gov/resource/ppwx-mtmh.json?$select=date_trunc_ymd(close_date)%20as%20date,count(*)%20as%20count&$group=date_trunc_ymd(close_date)&$order=date_trunc_ymd(close_date)&$where=close_date%20IS%20NOT%20NULL';
  var data = JSON.parse($.ajax({
            type: "GET",
            url: url,
            async: false
        }).responseText);
  var labels = [];
  var counts = [];
  $.each(data, function(i, v) {
    labels.push(v['date']);
    counts.push(parseInt(v['count']));
  });
	// line chart data
	var buyerData = {
		labels : labels,
		datasets : [
		{
				fillColor : "rgba(172,194,132,0.4)",
				strokeColor : "#ACC26D",
				pointColor : "#fff",
				pointStrokeColor : "#9DB86D",
				data : counts,
        pointHighlightFill: "blue",
        pointHighlightStroke: "rgba(220,220,220,1)"
        
			}
		]
    
	}
	
	// get line chart canvas
	var closed_requests_per_day = document.getElementById('closed_requests_per_day').getContext('2d');

	// draw line chart
	new Chart(opened_requests_per_day).Line(buyerData,{pointHitDetectionRadius:5,customTooltips: function (tooltip) {
        var tooltipEl = $('#chartjs-tooltip');

        if (!tooltip) {
            tooltipEl.css({
                opacity: 0
            });
            return;
        }
       
        tooltipEl.removeClass('above below');
        tooltipEl.addClass(tooltip.yAlign);
        console.log('hi');
        // split out the label and value and make your own tooltip here
        var parts = tooltip.text.split(":");
        console.log(parts);
        var url = 'https://data.seattle.gov/resource/ppwx-mtmh.json?$select=city_requestertype_internal as req,count(*) as count&$group=city_requestertype_internal&$where=date_trunc_ymd(create_date) = "'+parts[0]+':00:00"';
        var data = JSON.parse($.ajax({
            type: "GET",
            url: url,
            async: false
        }).responseText);
        dataBreakdowns = {}
        $.each(data, function(i, v) {
          dataBreakdowns[v['req']] = v['count'];
        });
        var innerHtml = '<span>'+parts[3]+' requests</span><br/>Requester types<br/><table class="breakdown"><tr>';
        breakdown_headers = ['Media', 'Attorney', 'Individual', 'Insurance', 'Public Agency', 'Other', 'Inmate', 'Unknown'];
        breakdown_headers_html = '';
        breakdown_counts_html = '';
        $.each(breakdown_headers, function(i, v) {
          breakdown_headers_html += '<th>'+v+'</th>';
          if (v=='Unknown') {
            var url = 'https://data.seattle.gov/resource/ppwx-mtmh.json?$select=count(*) as count&$where=city_requestertype_internal IS NULL AND date_trunc_ymd(create_date) = "'+parts[0]+':00:00"';
            var data = JSON.parse($.ajax({
                type: "GET",
                url: url,
                async: false
            }).responseText);
            try {
              breakdown_counts_html += '<td>('+data[0]['count']+')</td>';
            } catch (e) {
              breakdown_counts_html += '<td>0% (0)</td>';
            }
          } else {
            if (v in dataBreakdowns) {
              breakdown_counts_html += '<td>('+dataBreakdowns[v]+')</td>';
            } else {
              breakdown_counts_html += '<td>0% (0)</td>';
            }
          }
        });
        innerHtml += breakdown_headers_html +'</tr><tr>'+breakdown_counts_html+'</tr></table>';
        innerHtml += 'Request statuses<br/>';
        innerHtml += 'Request sources<br/>';
        innerHtml += 'Receipt preferences<br/>';
        tooltipEl.html(innerHtml);

        tooltipEl.css({
            opacity: 1,
            left: tooltip.chart.canvas.offsetLeft + tooltip.x + 'px',
            top: tooltip.chart.canvas.offsetTop + tooltip.y + 'px',
            fontFamily: tooltip.fontFamily,
            fontSize: tooltip.fontSize,
            fontStyle: tooltip.fontStyle,
        });
    }});
</script>
        <!--/main col-->
    </div>

</div>
<!--/.container-->
<footer class="container-fluid">
    <p class="text-right small">©2015 Company</p>
</footer>


<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                    <span class="sr-only">Close</span>
                </button>
                <h4 class="modal-title" id="myModalLabel">Large Modal</h4>
            </div>
            <div class="modal-body">
                This is a dashboard layout for Bootstrap 4. This is an example of the Modal component which you can use to show content. Any content can be placed inside the modal and it can use the Bootstrap grid classes.
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary-outline" data-dismiss="modal">OK</button>
            </div>
        </div>
    </div>
</div>
  
  <script>
    // sandbox disable popups
    if (window.self !== window.top && window.name!="view1") {;
      window.alert = function(){/*disable alert*/};
      window.confirm = function(){/*disable confirm*/};
      window.prompt = function(){/*disable prompt*/};
      window.open = function(){/*disable open*/};
    }
    
    // prevent href=# click jump
    document.addEventListener("DOMContentLoaded", function() {
      var links = document.getElementsByTagName("A");
      for(var i=0; i < links.length; i++) {
        if(links[i].href.indexOf('#')!=-1) {
          links[i].addEventListener("click", function(e) {
          console.debug("prevent href=# click");
              if (this.hash) {
                if (this.hash=="#") {
                  e.preventDefault();
                  return false;
                }
                else {
    \\              /*
                  var el = document.getElementById(this.hash.replace(/#/, ""));
                  if (el) {
                    el.scrollIntoView(true);
                  }
                  */
                }
              }
              return false;
          })
        }
      }
    }, false);
  </script>
  
  <!--scripts loaded here-->
  
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.2/js/bootstrap.min.js"></script>
  
  
  
  <script>
  $(document).ready(function() {
    
  $('[data-toggle=offcanvas]').click(function() {
    $('.row-offcanvas').toggleClass('active');
  });
  
});
  </script>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-75239819-1', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>
